import matplotlib.pyplot as plt
import os
from operator import itemgetter

def plotter(arrays, energymin, names, experiment):
    f, ax = plt.subplots(1, 1)
    for i in range(0,len(arrays)):
        ax.plot(arrays[i], label = f"{names[i]} nodes")
    
    folder = "irem_plots"
    save_path = os.path.join(folder,f"{experiment}_multi")
    ax.legend(loc="upper left", bbox_to_anchor=(1, 0.5))
    min = []
    txt = "Trained on 10 nodes\n"
    for i in range(0, len(arrays)):
        txt = txt + f"For {names[i]} nodes, optimal is {arrays[i][energymin[i]]}\n"
    plt.figtext(0.5, 0, txt, wrap=True, horizontalalignment='center', fontsize=12, va='top')
    plt.xlabel('Iterations')
    plt.ylabel('MSE loss')
    if experiment == "sp":
        plt.title("MSE Loss for IREM Shortest Path")
    elif experiment == "identity":
        plt.title("MSE Loss for IREM Indentity")
    else:
        plt.title("MSE Loss for IREM Connected Components")
    plt.savefig(save_path, bbox_inches="tight", dpi=500)

# SP data
# experiment = "sp"
# rank10 = [0.8038, 0.6257, 0.5043, 0.4144, 0.3456, 0.2930, 0.2533, 0.2234, 0.2008, 0.1834, 0.1697, 0.1586, 0.1494, 0.1419, 0.1356, 0.1306, 0.1266, 0.1234, 0.1211, 0.1194, 0.1183, 0.1176, 0.1174, 0.1175, 0.1179, 0.1185, 0.1193, 0.1202, 0.1212, 0.1223]
# energy10 = [-4.1743, -4.2012, -4.2172, -4.2277, -4.2355, -4.2417, -4.2465, -4.2501, -4.2528, -4.2548, -4.2563, -4.2575, -4.2584, -4.2591, -4.2598, -4.2604, -4.2609, -4.2614, -4.2618, -4.2622, -4.2625, -4.2628, -4.2631, -4.2634, -4.2636, -4.2638, -4.2639, -4.2641, -4.2642, -4.2643]
# rank20 = [0.9184, 0.8932, 0.8695, 0.8469, 0.8252, 0.8042, 0.7838, 0.7640, 0.7447, 0.7261, 0.7079, 0.6904, 0.6734, 0.6570, 0.6412, 0.6259, 0.6111, 0.5970, 0.5833, 0.5703, 0.5578, 0.5459, 0.5345, 0.5237, 0.5134, 0.5037, 0.4946, 0.4860, 0.4780, 0.4705]
# energy20 = [-16.3985, -16.4020, -16.4042, -16.4058, -16.4072, -16.4085, -16.4097, -16.4109, -16.4120, -16.4132, -16.4144, -16.4155, -16.4167, -16.4178, -16.4190, -16.4201, -16.4212, -16.4224, -16.4235, -16.4247, -16.4258, -16.4269, -16.4281, -16.4292, -16.4303, -16.4315, -16.4326, -16.4337, -16.4348, -16.4360]
# rank30 = [0.8424, 0.8364, 0.8328, 0.8306, 0.8292, 0.8283, 0.8280, 0.8283, 0.8289, 0.8296, 0.8304, 0.8311, 0.8316, 0.8321, 0.8324, 0.8327, 0.8329, 0.8329, 0.8329, 0.8328, 0.8326, 0.8322, 0.8316, 0.8310, 0.8302, 0.8294, 0.8286, 0.8277, 0.8269, 0.8261]
# energy30 = [-33.6485, -33.6624, -33.6746, -33.6857, -33.6954, -33.7038, -33.7112, -33.7178, -33.7239, -33.7297, -33.7350, -33.7399, -33.7445, -33.7488, -33.7528, -33.7566, -33.7602, -33.7637, -33.7670, -33.7701, -33.7731, -33.7760, -33.7787, -33.7813, -33.7839, -33.7863, -33.7886, -33.7909, -33.7931, -33.7952]
# rank40 = [0.7867, 0.7906, 0.7958, 0.8019, 0.8084, 0.8154, 0.8228, 0.8307, 0.8387, 0.8467, 0.8544, 0.8618, 0.8688, 0.8754, 0.8815, 0.8873, 0.8926, 0.8976, 0.9020, 0.9060, 0.9096, 0.9127, 0.9153, 0.9176, 0.9195, 0.9211, 0.9224, 0.9235, 0.9244, 0.9251]
# energy40 = [-51.5665, -51.5843, -51.5992, -51.6121, -51.6231, -51.6326, -51.6410, -51.6489, -51.6563, -51.6632, -51.6696, -51.6753, -51.6804, -51.6851, -51.6893, -51.6932, -51.6967, -51.6999, -51.7029, -51.7056, -51.7080, -51.7102, -51.7121, -51.7139, -51.7155, -51.7170, -51.7183, -51.7195, -51.7207, -51.7217]

# Identity data
experiment = "identity"
# rank10 = [0.2981, 0.1872, 0.1308, 0.0968, 0.0748, 0.0600, 0.0499, 0.0427, 0.0374, 0.0335, 0.0305, 0.0282, 0.0264, 0.0248, 0.0236, 0.0225, 0.0217, 0.0210, 0.0204, 0.0199, 0.0196, 0.0193, 0.0191, 0.0189, 0.0188, 0.0188, 0.0187, 0.0187, 0.0188, 0.0188]
# energy10 = [1.1672, 1.1022, 1.0878, 1.0811, 1.0772, 1.0749, 1.0733, 1.0723, 1.0716, 1.0711, 1.0707, 1.0704, 1.0702, 1.0700, 1.0699, 1.0697, 1.0696, 1.0695, 1.0694, 1.0693, 1.0693, 1.0692, 1.0691, 1.0691, 1.0690, 1.0690, 1.0690, 1.0689, 1.0689, 1.0689]
# rank20 = [0.3947, 0.3137, 0.2776, 0.2599, 0.2519, 0.2500, 0.2513, 0.2547, 0.2584, 0.2621, 0.2653, 0.2681, 0.2704, 0.2724, 0.2739, 0.2753, 0.2763, 0.2772, 0.2780, 0.2785, 0.2790, 0.2795, 0.2798, 0.2801, 0.2804, 0.2806, 0.2808, 0.2810, 0.2812, 0.2813]
# energy20 = [10.7589, 10.4988, 10.4318, 10.3999, 10.3804, 10.3684, 10.3610, 10.3561, 10.3529, 10.3507, 10.3491, 10.3479, 10.3471, 10.3463, 10.3459, 10.3454, 10.3451, 10.3448, 10.3446, 10.3444, 10.3442, 10.3441, 10.3440, 10.3439, 10.3438, 10.3437, 10.3437, 10.3436, 10.3436, 10.3435]
# rank30 = [0.4022, 0.2730, 0.2167, 0.1919, 0.1808, 0.1754, 0.1721, 0.1708, 0.1706, 0.1707, 0.1706, 0.1707, 0.1706, 0.1707, 0.1706, 0.1706, 0.1706, 0.1706, 0.1705, 0.1706, 0.1705, 0.1705, 0.1704, 0.1704, 0.1703, 0.1703, 0.1703, 0.1703, 0.1702, 0.1702]
# energy30 = [34.0922, 33.5718, 33.3558, 33.2669, 33.2297, 33.2126, 33.2045, 33.2009, 33.1991, 33.1985, 33.1978, 33.1973, 33.1969, 33.1966, 33.1963, 33.1961, 33.1959, 33.1957, 33.1955, 33.1954, 33.1952, 33.1952, 33.1951, 33.1949, 33.1949, 33.1948, 33.1947, 33.1947, 33.1946, 33.1946]

# Identity 10 iters data
rank10 = [0.2981, 0.1870, 0.1307, 0.0967, 0.0747, 0.0601, 0.0500, 0.0428, 0.0375, 0.0336, 0.0307, 0.0284, 0.0265, 0.0250, 0.0237, 0.0227, 0.0218, 0.0211, 0.0206, 0.0201, 0.0198, 0.0195, 0.0193, 0.0191, 0.0190, 0.0189, 0.0189, 0.0189, 0.0189, 0.0189]
energy10 = [1.1671, 1.1022, 1.0877, 1.0810, 1.0772, 1.0748, 1.0733, 1.0722, 1.0715, 1.0710, 1.0706, 1.0703, 1.0701, 1.0699, 1.0698, 1.0697, 1.0695, 1.0694, 1.0693, 1.0693, 1.0692, 1.0691, 1.0691, 1.0690, 1.0690, 1.0689, 1.0689, 1.0689, 1.0688, 1.0688]
rank20 = [0.3941, 0.3132, 0.2768, 0.2593, 0.2513, 0.2494, 0.2505, 0.2541, 0.2572, 0.2616, 0.2641, 0.2673, 0.2694, 0.2718, 0.2727, 0.2745, 0.2753, 0.2764, 0.2765, 0.2777, 0.2778, 0.2785, 0.2787, 0.2791, 0.2792, 0.2797, 0.2795, 0.2798, 0.2799, 0.2802]
energy20 = [10.7477, 10.4876, 10.4207, 10.3888, 10.3694, 10.3576, 10.3502, 10.3453, 10.3421, 10.3398, 10.3383, 10.3371, 10.3362, 10.3355, 10.3350, 10.3344, 10.3342, 10.3339, 10.3339, 10.3336, 10.3334, 10.3332, 10.3332, 10.3330, 10.3329, 10.3329, 10.3328, 10.3328, 10.3327, 10.3327]
rank30 = [0.4023, 0.2731, 0.2168, 0.1920, 0.1808, 0.1753, 0.1721, 0.1708, 0.1706, 0.1707, 0.1705, 0.1706, 0.1706, 0.1706, 0.1705, 0.1706, 0.1705, 0.1706, 0.1705, 0.1705, 0.1704, 0.1703, 0.1703, 0.1703, 0.1703, 0.1703, 0.1702, 0.1702, 0.1702, 0.1700]
energy30 = [34.0954, 33.5751, 33.3592, 33.2703, 33.2332, 33.2161, 33.2080, 33.2046, 33.2028, 33.2021, 33.2014, 33.2009, 33.2004, 33.2001, 33.1997, 33.1996, 33.1994, 33.1992, 33.1990, 33.1988, 33.1987, 33.1986, 33.1984, 33.1984, 33.1985, 33.1982, 33.1983, 33.1981, 33.1982, 33.1981]
rank40 = [0.5682, 0.3901, 0.3272, 0.3379, 0.2755, 0.2670, 0.2825, 0.2794, 0.2663, 0.2765, 0.2625, 0.2708, 0.2859, 0.2636, 0.2743, 0.2852, 0.2714, 0.2746, 0.2884, 0.2734, 0.2783, 0.2873, 0.2792, 0.2800, 0.2883, 0.2780, 0.2852, 0.2872, 0.2824, 0.2855]
energy40 = [76.4516, 75.2913, 74.9156, 74.8239, 74.8023, 74.6818, 74.6864, 74.6894, 74.6941, 74.6648, 74.6686, 74.6438, 74.6680, 74.6731, 74.6424, 74.6565, 74.6743, 74.6415, 74.6538, 74.6688, 74.6457, 74.6465, 74.6692, 74.6459, 74.6500, 74.6591, 74.6473, 74.6503, 74.6599, 74.6449]

# Connected data 
# experiment = "connected"
# rank10 = [0.5289, 0.4598, 0.4068, 0.3638, 0.3281, 0.2983, 0.2735, 0.2529, 0.2360, 0.2222, 0.2111, 0.2023, 0.1952, 0.1895, 0.1852, 0.1816, 0.1788, 0.1766, 0.1747, 0.1733, 0.1722, 0.1713, 0.1705, 0.1699, 0.1694, 0.1691, 0.1687, 0.1686, 0.1684, 0.1682]
# energy10 = [1.8738, 1.8653, 1.8598, 1.8558, 1.8526, 1.8498, 1.8475, 1.8455, 1.8438, 1.8424, 1.8412, 1.8403, 1.8395, 1.8389, 1.8384, 1.8380, 1.8376, 1.8374, 1.8372, 1.8370, 1.8369, 1.8368, 1.8367, 1.8366, 1.8366, 1.8365, 1.8365, 1.8364, 1.8364, 1.8364]
# rank20 = [0.5582, 0.4764, 0.4904, 0.4760, 0.4388, 0.4196, 0.4043, 0.4000, 0.3962, 0.3965, 0.3924, 0.3913, 0.3894, 0.3880, 0.3877, 0.3863, 0.3867, 0.3855, 0.3857, 0.3847, 0.3853, 0.3841, 0.3854, 0.3840, 0.3852, 0.3837, 0.3847, 0.3846, 0.3843, 0.3841]
# energy20 = [10.6705, 10.0169,  9.7576,  9.5978,  9.5730,  9.5624,  9.5472,  9.5425, 9.5419,  9.5435,  9.5445,  9.5438,  9.5415,  9.5400,  9.5388,  9.5385, 9.5377,  9.5376,  9.5364,  9.5370,  9.5365,  9.5361,  9.5367,  9.5362, 9.5363,  9.5361,  9.5362,  9.5354,  9.5362,  9.5355]
# rank30 = [0.4710, 1.0271, 0.8774, 0.8191, 0.7656, 0.7179, 0.6784, 0.6459, 0.6213, 0.6040, 0.5935, 0.5884, 0.5880, 0.5900, 0.5957, 0.6007, 0.6072, 0.6131, 0.6195, 0.6243, 0.6297, 0.6343, 0.6388, 0.6416, 0.6445, 0.6472, 0.6492, 0.6512, 0.6528, 0.6536]
# energy30 = [40.6636, 33.8742, 32.3159, 32.2071, 32.1424, 32.0987, 32.0677, 32.0446, 32.0280, 32.0161, 32.0059, 32.0000, 31.9953, 31.9922, 31.9931, 31.9915, 31.9937, 31.9945, 31.9970, 31.9986, 31.9999, 32.0022, 32.0048, 32.0062, 32.0069, 32.0090, 32.0101, 32.0121, 32.0130, 32.0140]
# rank40 = [0.7097, 2.1270, 2.8015, 2.8555, 2.8344, 2.8235, 2.8025, 2.8107, 2.7860, 2.8415, 2.7780, 2.8661, 2.7728, 2.8658, 2.7702, 2.8664, 2.7742, 2.8691, 2.7768, 2.8728, 2.7804, 2.8755, 2.7829, 2.8774, 2.7851, 2.8806, 2.7880, 2.8818, 2.7881, 2.8835]
# energy40 = [111.1252,  78.2130,  71.8417,  71.2074,  71.0724,  70.9694,  70.8942, 70.8306,  70.7875,  70.7638,  70.7790,  70.8121,  70.8536,  70.8613, 70.8775,  70.8735,  70.8885,  70.8797,  70.8885,  70.8809,  70.8913, 70.8806,  70.8923,  70.8802,  70.8929,  70.8808,  70.8920,  70.8823, 70.8921,  70.8810]

arrays = []
energies = []
energies.append(energy10)
arrays.append(rank10)
energies.append(energy20)
arrays.append(rank20)
energies.append(energy30)
arrays.append(rank30)
energies.append(energy40)
arrays.append(rank40)
# energies.append(energy50)
# arrays.append(rank50)
# energies.append(energy60)
# arrays.append(rank60)

energymin = []
for i in range(0,len(energies)):
    index, element = min(enumerate(energies[i]), key=itemgetter(1))
    # print("min element is ",index," ", element)
    energymin.append(index)

names = ["10",'20','30','40']#,'50','60']
plotter(arrays, energymin, names, experiment)